---
description: "Global engineering standards — process, architecture, quality gates, git"
alwaysApply: true
---

# Global Engineering Standards

## Process

All structural changes follow: ADR → Design → TDD → Implement → Verify.

- **ADR first**: Before architectural changes, write an ADR in `docs/adr/`. No structural code without rationale.
- **Plan before code**: Use `/spec` for non-trivial work. Explore and design precede implementation.
- **TDD mandatory**: Write failing tests FIRST. Red → Green → Refactor.
- **Verify before done**: Run linters, type checkers, and tests before marking work complete.

## Quality Gates (before every commit)

1. Format (ruff format / gofumpt / prettier + tailwindcss plugin)
2. Lint (ruff check / golangci-lint / eslint)
3. Type check (basedpyright / go vet / tsc --noEmit)
4. Unit tests for changed modules

## Git Conventions

- Conventional commits: `<type>: <description>` (feat, fix, refactor, docs, test, chore, perf, ci)
- Branch naming: `<type>/<short-description>`
- Never force-push to main/master

## Architecture Patterns

- Clean/layered: Foundation → Client → Service/Domain → Controller/API
- Dependency injection at composition root
- Repository pattern for data access
- Event-driven messaging between services
- Early returns over nested conditionals
- Separate persistence models, domain entities, and DTOs

## Anti-Patterns to Avoid

- Files >800 lines, functions >50 lines, nesting >4 levels
- Hardcoded secrets/URLs/config values
- Mutable shared state across goroutines/async tasks
- `any`/`interface{}` without type narrowing
- Import cycles
- Testing implementation details instead of behavior
